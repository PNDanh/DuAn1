CREATE DATABASE DUAN1_NHOM6_PMBANQUANAO
GO
USE DUAN1_NHOM6_PMBANQUANAO
GO

CREATE TABLE SanPham
(
  IdSP UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
  MaSP VARCHAR(20) UNIQUE,
  TenSP NVARCHAR(50) DEFAULT NULL,
  TinhTrang INT
) 
GO
INSERT INTO SanPham(MaSP,TenSP,TinhTrang)
VALUES('SP01',N'Áo',1)

SELECT * FROM SanPham

CREATE TABLE LoaiSP
(
  IdLoaiSP UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
  MaLoai VARCHAR(20) UNIQUE,
  TenLoai NVARCHAR(50) DEFAULT NULL,
  TinhTrang INT
) 
GO
INSERT INTO LoaiSP(MaLoai,TenLoai,TinhTrang)
VALUES('L01',N'Polo',1)

SELECT * FROM LoaiSP

CREATE TABLE ChatLieu
(
  IdCL UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
  MaCL VARCHAR(20) UNIQUE,
  TenCL NVARCHAR(50) DEFAULT NULL
) 
GO
INSERT INTO ChatLieu(MaCL,TenCL)
VALUES('CL01',N'Cotton')

SELECT * FROM ChatLieu

CREATE TABLE Size
(
  IdSize UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
  MaSize VARCHAR(20) UNIQUE,
  TenSize NVARCHAR(50) DEFAULT NULL
) 
GO
INSERT INTO Size(MaSize,TenSize)
VALUES('SZ01',N'Size 2XL')

SELECT * FROM Size

CREATE TABLE MauSac
(
  IdMau UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
  MaMau VARCHAR(20) UNIQUE,
  TenMau NVARCHAR(50) DEFAULT NULL
) 
GO
INSERT INTO MauSac(MaMau,TenMau)
VALUES('M01',N'PINK')

SELECT * FROM MauSac

CREATE TABLE ChiTietSP
(
  IdCTSP UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
  IdSP UNIQUEIDENTIFIER,
  IdLoaiSP UNIQUEIDENTIFIER,
  IdCL UNIQUEIDENTIFIER,
  IdSize UNIQUEIDENTIFIER,
  IdMau UNIQUEIDENTIFIER,
  SoLuongTon INT,
  Gia DECIMAL(20,0) DEFAULT 0,
  MoTa NVARCHAR(100) DEFAULT NULL,
  TinhTrang INT,
  NgayTao DATE DEFAULT NULL,
  NgaySua DATE DEFAULT NULL,
  FOREIGN KEY (IdSP) REFERENCES SanPham(IdSP),
  FOREIGN KEY (IdLoaiSP) REFERENCES LoaiSP(IdLoaiSP),
  FOREIGN KEY (IdCL) REFERENCES ChatLieu(IdCL),
  FOREIGN KEY (IdSize) REFERENCES Size(IdSize),
  FOREIGN KEY (IdMau) REFERENCES MauSac(IdMau)
)
GO

INSERT INTO ChiTietSP(IdSP, IdLoaiSP, IdCL, IdSize, IdMau, SoLuongTon, Gia, MoTa, TinhTrang, NgayTao, NgaySua)
VALUES('8517EE0C-EAB6-4265-8468-4737982E2854','0EB25333-C5DE-4DD8-99B7-1BF1FFE48FC4','15081B31-1142-443C-8F72-70A187EABD1A','A31CC203-3027-4732-9BC6-0066D231BE3A',
'DAB498AA-5A30-4B10-A4F5-1180687D13E0', 20, 150000, N'ĐỐT KHÔNG CHÁY, CẮT KHÔNG RÁCH, SÚNG BẮN KHÔNG THỦNG', 1, '10-11-2022','11-11-2022')

SELECT*FROM ChiTietSP

CREATE TABLE ChucVu
(
  IdCV UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
  MaCV VARCHAR(20) UNIQUE,
  TenCV NVARCHAR(50) DEFAULT NULL
) 
GO

INSERT INTO ChucVu(MaCV,TenCV)
VALUES('CV01',N'Nhân Viên')

SELECT * FROM ChucVu

CREATE TABLE NguoiDung
(
	Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
	IdCV UNIQUEIDENTIFIER,
	MaND VARCHAR(20) UNIQUE,
	TenTK NVARCHAR(30),
	MatKhau VARCHAR(MAX) DEFAULT NULL,
	HoVaTen NVARCHAR(100) DEFAULT NULL,
	GioiTinh NVARCHAR(10) DEFAULT NULL,
	NgaySinh DATE DEFAULT NULL,
	Email NVARCHAR(50) DEFAULT NULL,
	Sdt VARCHAR(10) DEFAULT NULL,
	DiaChi NVARCHAR(100) DEFAULT NULL,
	[CCCD/CMT] NVARCHAR(12) DEFAULT NULL,
	TinhTrang INT,
	NgayTao DATE DEFAULT NULL,
	NgaySua DATE DEFAULT NULL,
	FOREIGN KEY (IdCV) REFERENCES ChucVu(IdCV),
)
GO

INSERT INTO NguoiDung(IdCV,MaND,TenTK,MatKhau, HoVaTen, GioiTinh, NgaySinh, Email, Sdt, DiaChi, [CCCD/CMT], TinhTrang, NgayTao, NgaySua)
VALUES('4634FF2C-3C35-4BE6-AECE-ED2ECED2B7B8',N'ND01','nv1',123,N'Phan Ngọc Danh',N'Nam',
'1-12-2003','danhpnph26382@fpt.edu.vn','0932343783',N'Hồ Tùng Mậu','001304656874',1,'10-11-2022','11-11-2022')

SELECT*FROM NguoiDung

CREATE TABLE KhachHang
(
	IdKH UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
	MaKH VARCHAR(20) UNIQUE,
	HoVaTen NVARCHAR(100) DEFAULT NULL,
	GioiTinh NVARCHAR(10) DEFAULT NULL,
	DiaChi NVARCHAR(100) DEFAULT NULL,
	Sdt VARCHAR(10) DEFAULT NULL,
	NgaySinh DATE DEFAULT NULL,
	NgayTao DATE DEFAULT NULL,
	NgaySua DATE DEFAULT NULL,
)
GO

INSERT INTO KhachHang(MaKH, HoVaTen, GioiTinh, DiaChi, Sdt, NgaySinh, NgayTao, NgaySua)
VALUES ('KH01',N'Nguyễn Thúy Hằng',N'Nữ',N'Nam Định','0866127018','03-12-2003','10-11-2022','11-11-2022')
update KhachHang set DiaChi = N'Nam Định' where MaKH = 'KH01'
SELECT * FROM KhachHang

CREATE TABLE HoaDon
(
	IdHD UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
	IdND UNIQUEIDENTIFIER,
	IdKH UNIQUEIDENTIFIER,
	MaHD VARCHAR(20) UNIQUE,
	PhuongThucTT INT,
	TongTien DECIMAL(20,0) DEFAULT 0,
	TinhTrang INT,
	NgayTao DATE DEFAULT NULL,
	NgaySua DATE DEFAULT NULL,
	FOREIGN KEY (IdND) REFERENCES NguoiDung(Id),
	FOREIGN KEY (IdKH) REFERENCES KhachHang(IdKH),

)
GO

SELECT * FROM HoaDon

CREATE TABLE KhuyenMai
(
	IdKM UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
	MaKM VARCHAR(20) UNIQUE,
	TenKM NVARCHAR(50),
	NgayBatDau DATE DEFAULT NULL,
	NgayKetThuc DATE DEFAULT NULL,
	MoTa NVARCHAR(50) DEFAULT NULL,
	GiamGia INT,
	TinhTrang INT,
	NgayTao DATE DEFAULT NULL,
	NgaySua DATE DEFAULT NULL,

)
GO

INSERT INTO KhuyenMai(MaKM, TenKM, NgayBatDau, NgayKetThuc, MoTa, GiamGia, TinhTrang, NgayTao, NgaySua)
VALUES('KM01','SALE 20-11','2022-11-19','2022-11-20', N'Không Sale',0,1,'10-11-2022','11-11-2022')
update KhuyenMai set MaKM = 'KM00' where IdKM = '44BF21A6-B5CF-44B5-B48F-BC186C3D48B5'
SELECT * FROM KhuyenMai

CREATE TABLE HoaDonCT
(
	IdHDCT UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
	IdHD UNIQUEIDENTIFIER,
	IdKM UNIQUEIDENTIFIER,
	IdCTSP UNIQUEIDENTIFIER,
	Gia DECIMAL(20,0) DEFAULT 0,
	SoLuongMua INT,
	GiaKM DECIMAL(20,0) DEFAULT 0,
	FOREIGN KEY (IdHD) REFERENCES HoaDon(IdHD),
	FOREIGN KEY (IdCTSP) REFERENCES ChiTietSP(IdCTSP),
	FOREIGN KEY (IdKM) REFERENCES KhuyenMai(IdKM),

)
GO
INSERT INTO HoaDonCT(IdHD,IdKM,IdCTSP,Gia,SoLuongMua,GiaKM)
VALUES('56B8DC09-5299-40F1-8A0A-78A2A7BDA668','2EFD1EBA-B284-44B7-87B7-E74B6031774C', 'A0F3B523-E74B-47F3-8E32-5E6AAC858C6E', 150000 ,1,150000)

SELECT * FROM HoaDonCT

CREATE TABLE Anh
(
  IdAnh UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
  IDCTSP UNIQUEIDENTIFIER,
  MaAnh VARCHAR(20) UNIQUE,
  TenAnh NVARCHAR(50) DEFAULT NULL,
  DuongDanAnh image DEFAULT NULL,
  FOREIGN KEY (IDCTSP) REFERENCES ChiTietSP(IDCTSP),
) 
GO
INSERT INTO Anh(IDCTSP, MaAnh, TenAnh, DuongDanAnh)
VALUES('E0BEE44B-DC61-4D3F-BDF9-4C5B951906F0','A01',N'ẢNH Áo POLO',NULL)

SELECT * FROM Anh

CREATE TABLE DoiTra
(
  IdDoiTra UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
  IDHD UNIQUEIDENTIFIER,
  LyDoDoiTra NVARCHAR(200) UNIQUE,
  NgayDoiTra DATE DEFAULT NULL, 
  HanDoiTra DATE DEFAULT NULL, 
  FOREIGN KEY (IDHD) REFERENCES HoaDon(IDHD),
) 
GO

INSERT INTO DoiTra(IDHD, LyDoDoiTra, NgayDoiTra, HanDoiTra)
VALUES('56B8DC09-5299-40F1-8A0A-78A2A7BDA668',N'Sản phẩm khác với mô tả: Đốt vẫn cháy','2022-11-13','2022-11-15')

SELECT * FROM DoiTra

